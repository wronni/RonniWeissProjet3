<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Hallway - Three Worlds Await</title>
    <meta name="description" content="Three mystical doors, three incredible worlds. Which path will you choose?">
    <meta property="og:title" content="The Hallway - Interactive Adventure">
    <meta property="og:description" content="Explore magical forests, neon cities, and endless oceans">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            color: #fff;
            position: relative;
            overflow-x: hidden;
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        body {
            background: linear-gradient(135deg, #667eea, #764ba2, #f093fb, #667eea);
            background-size: 300% 300%;
            animation: gradientShift 15s ease infinite;
        }

        .particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .particle {
            position: absolute;
            font-size: 20px;
            opacity: 0;
            animation: sparkle 3s infinite;
        }

        @keyframes sparkle {
            0%, 100% { opacity: 0; transform: translateY(0) scale(0); }
            50% { opacity: 1; transform: translateY(-100px) scale(1); }
        }

        .controls {
            position: fixed;
            top: 20px;
            right: 20px;
            display: flex;
            gap: 10px;
            z-index: 1000;
        }

        .control-btn {
            background: rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(10px);
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.2em;
            transition: all 0.3s;
            border: 2px solid rgba(255, 255, 255, 0.5);
        }

        .control-btn:hover {
            background: rgba(255, 255, 255, 0.5);
            transform: scale(1.1) rotate(10deg);
        }

        .container {
            max-width: 900px;
            width: 100%;
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 50px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.2);
            position: relative;
            z-index: 10;
        }

        .breadcrumbs {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            font-size: 0.9em;
        }

        .breadcrumb {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        h1 {
            font-size: 3em;
            text-align: center;
            margin-bottom: 15px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            font-weight: 300;
            letter-spacing: 2px;
            animation: titleFloat 3s ease-in-out infinite;
        }

        @keyframes titleFloat {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .subtitle {
            text-align: center;
            font-size: 1.2em;
            margin-bottom: 40px;
            opacity: 0.9;
            font-weight: 300;
        }

        .scene-text {
            font-size: 1.3em;
            line-height: 1.8;
            margin-bottom: 40px;
            text-align: center;
            font-weight: 300;
        }

        .doors-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .door {
            height: 450px;
            border-radius: 20px 20px 5px 5px;
            cursor: pointer;
            transition: all 0.5s ease;
            text-align: center;
            position: relative;
            overflow: hidden;
            border: 5px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .door.keyboard-focus {
            outline: 5px solid white;
            outline-offset: 5px;
        }

        .door::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.3);
            opacity: 0.3;
            transition: opacity 0.4s ease;
            z-index: 1;
        }

        .door:hover::before {
            opacity: 0.1;
        }

        .door:hover {
            transform: scale(1.08) translateY(-10px);
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
            border-color: rgba(255, 255, 255, 0.6);
        }

        .door-content {
            position: relative;
            z-index: 2;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
            padding: 30px;
        }

        .door-icon {
            font-size: 5em;
            margin-bottom: 20px;
            display: block;
            filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.3));
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-15px); }
        }

        .door-title {
            font-size: 1.8em;
            font-weight: 600;
            margin-bottom: 12px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }

        .door-description {
            font-size: 1em;
            opacity: 0.95;
            font-weight: 300;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.5);
            line-height: 1.4;
        }

        .door-handle {
            position: absolute;
            right: 30px;
            top: 50%;
            transform: translateY(-50%);
            width: 20px;
            height: 80px;
            background: linear-gradient(180deg, #ffd700, #ffed4e, #ffd700);
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.4);
            z-index: 3;
            transition: transform 0.3s ease;
        }

        .door:hover .door-handle {
            transform: translateY(-50%) rotate(-15deg);
            animation: handleShine 1s infinite;
        }

        @keyframes handleShine {
            0%, 100% { filter: brightness(1); }
            50% { filter: brightness(1.3); }
        }

        .door-handle::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 15px;
            height: 15px;
            background: #cc9900;
            border-radius: 50%;
        }

        .forest-door {
            background:
                linear-gradient(rgba(34, 139, 34, 0.7), rgba(85, 107, 47, 0.7)),
                url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 400 400"><rect fill="%23228B22" width="400" height="400"/><circle cx="100" cy="100" r="40" fill="%234d7c3b" opacity="0.6"/><circle cx="300" cy="150" r="50" fill="%234d7c3b" opacity="0.5"/></svg>');
            background-size: cover;
        }

        .city-door {
            background:
                linear-gradient(rgba(138, 43, 226, 0.6), rgba(75, 0, 130, 0.6)),
                url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 400 400"><rect fill="%23191970" width="400" height="400"/><rect x="50" y="200" width="40" height="200" fill="%23FF00FF" opacity="0.3"/></svg>');
            background-size: cover;
        }

        .ocean-door {
            background:
                linear-gradient(rgba(0, 105, 148, 0.7), rgba(72, 209, 204, 0.7)),
                url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 400 400"><rect fill="%23006994" width="400" height="400"/></svg>');
            background-size: cover;
        }

        .choices-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .choice-btn {
            background: rgba(255, 255, 255, 0.2);
            color: #fff;
            border: 2px solid rgba(255, 255, 255, 0.3);
            padding: 18px 25px;
            font-size: 1.15em;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
            font-weight: 300;
            position: relative;
            overflow: hidden;
        }

        .choice-btn.keyboard-focus {
            outline: 3px solid white;
            outline-offset: 3px;
        }

        .choice-btn::before {
            content: '‚ú®';
            position: absolute;
            right: 20px;
            opacity: 0;
            transition: all 0.3s;
        }

        .choice-btn:hover::before {
            opacity: 1;
            animation: sparkleMove 1s infinite;
        }

        @keyframes sparkleMove {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-5px) rotate(180deg); }
        }

        .choice-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            border-color: rgba(255, 255, 255, 0.5);
            transform: translateX(10px) scale(1.02);
            box-shadow: 0 5px 20px rgba(255, 255, 255, 0.3);
        }

        .back-btn {
            background: rgba(255, 255, 255, 0.15);
            color: #fff;
            border: 2px solid rgba(255, 255, 255, 0.3);
            padding: 15px 35px;
            font-size: 1.1em;
            border-radius: 12px;
            cursor: pointer;
            margin-top: 25px;
            transition: all 0.3s ease;
            font-weight: 300;
        }

        .back-btn:hover {
            background: rgba(255, 255, 255, 0.25);
            border-color: rgba(255, 255, 255, 0.5);
            transform: translateY(-3px);
        }

        .world-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .world-title {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 400;
        }

        .world-icon {
            font-size: 4em;
            margin-bottom: 15px;
            display: block;
            animation: worldIconSpin 20s linear infinite;
        }

        @keyframes worldIconSpin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .fade-in {
            animation: fadeIn 0.6s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fade-out {
            animation: fadeOut 0.3s ease-out;
        }

        @keyframes fadeOut {
            from { opacity: 1; }
            to { opacity: 0; }
        }

        .discovery {
            background: rgba(255, 255, 255, 0.1);
            border-left: 4px solid rgba(255, 255, 255, 0.5);
            padding: 20px;
            margin: 25px 0;
            border-radius: 8px;
            font-style: italic;
        }

        .tutorial-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 2000;
            display: flex;
            justify-content: center;
            align-items: center;
            animation: fadeIn 0.5s;
        }

        .tutorial-content {
            background: linear-gradient(135deg, #667eea, #764ba2);
            padding: 40px;
            border-radius: 20px;
            max-width: 500px;
            text-align: center;
            border: 2px solid rgba(255, 255, 255, 0.5);
        }

        .tutorial-content h2 {
            margin-bottom: 20px;
            font-size: 2em;
        }

        .tutorial-content p {
            margin-bottom: 15px;
            line-height: 1.6;
        }

        @media (max-width: 768px) {
            .container {
                padding: 30px 25px;
            }

            h1 {
                font-size: 2.2em;
            }

            .doors-container {
                grid-template-columns: 1fr;
            }

            .door-icon {
                font-size: 3em;
            }
        }

        .portal-effect {
            animation: portalWarp 0.8s;
        }

        @keyframes portalWarp {
            0% { transform: scale(1) rotate(0deg); opacity: 1; }
            50% { transform: scale(0) rotate(180deg); opacity: 0; }
            51% { transform: scale(0) rotate(-180deg); opacity: 0; }
            100% { transform: scale(1) rotate(0deg); opacity: 1; }
        }
    </style>
</head>
<body>
    <div class="particles" id="particles"></div>

    <div class="controls">
        <button class="control-btn" id="soundToggle" title="Toggle Sound">üîä</button>
        <button class="control-btn" id="saveBtn" title="Save Progress">üíæ</button>
        <button class="control-btn" id="helpBtn" title="Help">‚ùì</button>
    </div>

    <div class="container">
        <div id="breadcrumbs" class="breadcrumbs"></div>
        <div id="scene-content" class="fade-in"></div>
        <button class="back-btn" id="backBtn" style="display:none;">‚Üê Go Back</button>
    </div>

    <script>
        const scenes = {
            hallway: {
                type: 'doors',
                title: 'The Hallway',
                subtitle: 'Three doors. Three worlds. Which will you choose?',
                text: 'You find yourself standing in an endless hallway. The walls shimmer with an otherworldly light, and three ornate doors stand before you. Each door radiates a different energy, calling to you in its own unique way.',
                doors: [
                    {
                        id: 'forest',
                        icon: 'üå≤',
                        title: 'The Forest Door',
                        description: 'Carved from ancient oak, this door emanates the scent of pine and earth',
                        next: 'forestEntrance'
                    },
                    {
                        id: 'city',
                        icon: 'üåÜ',
                        title: 'The City Door',
                        description: 'Made of gleaming chrome and neon, pulsing with electric energy',
                        next: 'cityEntrance'
                    },
                    {
                        id: 'ocean',
                        icon: 'üåä',
                        title: 'The Ocean Door',
                        description: 'Formed from coral and seaglass, you can hear waves crashing beyond it',
                        next: 'oceanEntrance'
                    }
                ]
            },
            forestEntrance: {
                type: 'world',
                world: 'forest',
                icon: 'üå≤',
                title: 'The Enchanted Forest',
                text: 'You step through the door into a pristine forest. Sunlight filters through the canopy above, creating dancing patterns on the moss-covered ground. The air is fresh and alive with the sounds of birds and rustling leaves. Ancient trees tower around you, their trunks wider than cars.\n\nA path winds deeper into the woods, while you also notice a small clearing to your right with strange mushrooms growing in a perfect circle.',
                choices: [
                    { text: '‚Üí Follow the winding path deeper into the forest', next: 'forestPath' },
                    { text: '‚Üí Investigate the mushroom circle', next: 'mushroomCircle' },
                    { text: '‚Üí Climb one of the massive trees', next: 'climbTree' },
                    { text: '‚Üê Return to the hallway', next: 'hallway' }
                ]
            },
            forestPath: {
                type: 'world',
                world: 'forest',
                icon: 'üå≤',
                title: 'The Forest Path',
                text: 'You follow the path as it winds between the trees. After a while, you come upon a crystal-clear stream. A family of deer drinks from it peacefully. One of them, a magnificent stag with impressive antlers, looks directly at you without fear.',
                discovery: 'You feel a deep connection to this place. The forest accepts you as one of its own.',
                choices: [
                    { text: '‚Üí Sit by the stream and rest', next: 'streamRest' },
                    { text: '‚Üí Follow the deer when they leave', next: 'followDeer' },
                    { text: '‚Üí Wade into the stream', next: 'wadeStream' },
                    { text: '‚Üê Go back to the entrance', next: 'forestEntrance' }
                ]
            },
            streamRest: {
                type: 'world',
                world: 'forest',
                icon: 'üå≤',
                title: 'Peace by the Stream',
                text: 'You sit by the stream, listening to the gentle flow of water. Time seems to slow down. You feel more relaxed than you have in years. A butterfly lands on your hand, its wings shimmering with impossible colors.',
                discovery: 'In this place, you remember what it feels like to simply exist, without worry or hurry.',
                choices: [
                    { text: '‚Üí Stay here forever', next: 'forestEnding' },
                    { text: '‚Üê Return to the hallway', next: 'hallway' }
                ]
            },
            forestEnding: {
                type: 'ending',
                world: 'forest',
                icon: 'üå≤',
                title: 'One with the Forest',
                text: 'You decide to stay. Time passes differently here. Days feel like moments, moments feel like lifetimes. You become part of the forest, and it becomes part of you. This is where you belong.',
                discovery: 'You have found your true home.',
                showBack: true
            },
            cityEntrance: {
                type: 'world',
                world: 'city',
                icon: 'üåÜ',
                title: 'Neo-Tokyo',
                text: 'You step through the door into a dazzling futuristic metropolis. Neon lights in every color illuminate towering skyscrapers that seem to touch the stars. Flying vehicles zip through the air above you. Holographic advertisements flicker and pulse. The energy is electric, overwhelming, intoxicating.\n\nA sleek subway station entrance beckons to your left, while a busy night market sprawls to your right.',
                choices: [
                    { text: '‚Üí Take the subway deeper into the city', next: 'subway' },
                    { text: '‚Üí Explore the night market', next: 'nightMarket' },
                    { text: '‚Üí Enter one of the towering buildings', next: 'skyscraper' },
                    { text: '‚Üê Return to the hallway', next: 'hallway' }
                ]
            },
            subway: {
                type: 'world',
                world: 'city',
                icon: 'üåÜ',
                title: 'The Subway',
                text: 'You descend into the subway station. It\'s ultramodern, with screens showing destinations you\'ve never heard of. A train arrives silently, its doors opening with a soft hiss. Inside, a few passengers sit absorbed in glowing devices.',
                discovery: 'This subway goes to places beyond imagination.',
                choices: [
                    { text: '‚Üí Board the train to Downtown Core', next: 'downtown' },
                    { text: '‚Üí Board the train to The Heights', next: 'heights' },
                    { text: '‚Üê Go back to street level', next: 'cityEntrance' }
                ]
            },
            downtown: {
                type: 'world',
                world: 'city',
                icon: 'üåÜ',
                title: 'Downtown Core',
                text: 'The train brings you to the heart of the city. Massive screens display news, ads, and art. People rush by, absorbed in their own worlds. A robot offers you a map.',
                discovery: 'This is the pulse of the city - where everything converges.',
                choices: [
                    { text: '‚Üí Take the robot\'s map', next: 'cityEnding' },
                    { text: '‚Üê Return to hallway', next: 'hallway' }
                ]
            },
            cityEnding: {
                type: 'ending',
                world: 'city',
                icon: 'üåÜ',
                title: 'Become the City',
                text: 'You decide to stay in the city. You plug in, connect, become part of the digital neural network that runs through everything. You are the city now, and the city is you. Infinite information, infinite possibility.',
                discovery: 'You are no longer limited by physical form. You are everywhere and nowhere.',
                showBack: true
            },
            oceanEntrance: {
                type: 'world',
                world: 'ocean',
                icon: 'üåä',
                title: 'The Endless Ocean',
                text: 'You step through the door onto a pristine beach. Crystal-clear turquoise water stretches to the horizon. The sun is warm on your skin. Somehow, you can breathe underwater here - you just know it instinctively.\n\nA coral reef is visible in the shallows, while in the distance, you can see an island.',
                choices: [
                    { text: '‚Üí Dive into the coral reef', next: 'coralReef' },
                    { text: '‚Üí Swim to the distant island', next: 'island' },
                    { text: '‚Üí Walk along the beach', next: 'beachWalk' },
                    { text: '‚Üê Return to the hallway', next: 'hallway' }
                ]
            },
            coralReef: {
                type: 'world',
                world: 'ocean',
                icon: 'üåä',
                title: 'The Coral Reef',
                text: 'You dive beneath the waves. As promised, you can breathe underwater as easily as air. The coral reef is a riot of colors - fish of every hue dart around you. A sea turtle swims by, unbothered by your presence.',
                discovery: 'Down here, you feel weightless, free, reborn.',
                choices: [
                    { text: '‚Üí Swim deeper', next: 'deepOcean' },
                    { text: '‚Üí Follow the sea turtle', next: 'followTurtle' },
                    { text: '‚Üê Return to the beach', next: 'oceanEntrance' }
                ]
            },
            deepOcean: {
                type: 'world',
                world: 'ocean',
                icon: 'üåä',
                title: 'The Deep',
                text: 'You swim deeper and deeper. The light grows dim, but bioluminescent creatures light your way. You discover an underwater city - ancient ruins of a civilization long gone.',
                discovery: 'An entire world once existed here, beneath the waves.',
                choices: [
                    { text: '‚Üí Explore the ruins', next: 'oceanEnding' },
                    { text: '‚Üê Return to hallway', next: 'hallway' }
                ]
            },
            oceanEnding: {
                type: 'ending',
                world: 'ocean',
                icon: 'üåä',
                title: 'Part of the Ocean',
                text: 'You become part of the ocean. Your body dissolves into water, but your consciousness remains. You are the waves, the tides, the depths. You flow everywhere, touching all shores, connecting all lands. You are infinite.',
                discovery: 'You are no longer a single being, but part of the eternal dance of water.',
                showBack: true
            }
        };

        let currentScene = 'hallway';
        let history = [];
        let soundEnabled = true;
        let selectedChoice = 0;

        function createParticles() {
            const container = document.getElementById('particles');
            const particles = ['‚ú®', 'üí´', '‚≠ê', 'üåü', 'üí†'];
            for (let i = 0; i < 20; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.textContent = particles[Math.floor(Math.random() * particles.length)];
                particle.style.left = Math.random() * 100 + '%';
                particle.style.top = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 3 + 's';
                particle.style.animationDuration = (2 + Math.random() * 2) + 's';
                container.appendChild(particle);
            }
        }

        function saveProgress() {
            localStorage.setItem('hallwayProgress', JSON.stringify({
                scene: currentScene,
                history: history
            }));
            alert('‚ú® Progress saved!');
        }

        function loadProgress() {
            const saved = localStorage.getItem('hallwayProgress');
            if (saved) {
                const data = JSON.parse(saved);
                currentScene = data.scene;
                history = data.history || [];
                displayScene(currentScene);
            }
        }

        function displayScene(sceneKey) {
            const scene = scenes[sceneKey];
            const contentDiv = document.getElementById('scene-content');

            contentDiv.classList.remove('fade-in');
            contentDiv.classList.add('portal-effect');

            setTimeout(() => {
                let html = '';

                if (scene.type === 'doors') {
                    html = `
                        <h1>${scene.title}</h1>
                        <p class="subtitle">${scene.subtitle}</p>
                        <p class="scene-text">${scene.text}</p>
                        <div class="doors-container">
                    `;

                    scene.doors.forEach((door, index) => {
                        html += `
                            <div class="door ${door.id}-door" data-index="${index}" onclick="enterDoor('${door.next}')">
                                <div class="door-content">
                                    <span class="door-icon">${door.icon}</span>
                                    <div class="door-title">${door.title}</div>
                                    <div class="door-description">${door.description}</div>
                                </div>
                                <div class="door-handle"></div>
                            </div>
                        `;
                    });

                    html += '</div>';
                } else if (scene.type === 'world' || scene.type === 'ending') {
                    html = `
                        <div class="world-header">
                            <span class="world-icon">${scene.icon}</span>
                            <h2 class="world-title">${scene.title}</h2>
                        </div>
                        <p class="scene-text">${scene.text.replace(/\n\n/g, '</p><p class="scene-text">')}</p>
                    `;

                    if (scene.discovery) {
                        html += `<div class="discovery">${scene.discovery}</div>`;
                    }

                    if (scene.type === 'world') {
                        html += '<div class="choices-list">';
                        scene.choices.forEach((choice, index) => {
                            html += `<button class="choice-btn" data-index="${index}" onclick="makeChoice('${choice.next}')">${choice.text}</button>`;
                        });
                        html += '</div>';
                    } else if (scene.showBack) {
                        html += '<button class="back-btn" onclick="makeChoice(\'hallway\')">‚Üê Return to the Hallway</button>';
                    }
                }

                contentDiv.innerHTML = html;
                contentDiv.classList.remove('portal-effect');
                contentDiv.classList.add('fade-in');
                updateBreadcrumbs();
                document.getElementById('backBtn').style.display = history.length > 0 ? 'block' : 'none';
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }, 400);
        }

        function enterDoor(sceneKey) {
            history.push(currentScene);
            currentScene = sceneKey;
            displayScene(sceneKey);
            if (navigator.vibrate) navigator.vibrate(50);
        }

        function makeChoice(nextScene) {
            history.push(currentScene);
            currentScene = nextScene;
            displayScene(nextScene);
            if (navigator.vibrate) navigator.vibrate(50);
        }

        function goBack() {
            if (history.length > 0) {
                currentScene = history.pop();
                displayScene(currentScene);
            }
        }

        function updateBreadcrumbs() {
            const breadcrumbsDiv = document.getElementById('breadcrumbs');
            const path = [...history, currentScene].slice(-5);
            breadcrumbsDiv.innerHTML = path.map(s => {
                const scene = scenes[s];
                const icon = scene?.icon || 'üìç';
                return `<span class="breadcrumb">${icon} ${s}</span>`;
            }).join(' ‚Üí ');
        }

        document.getElementById('soundToggle').addEventListener('click', () => {
            soundEnabled = !soundEnabled;
            document.getElementById('soundToggle').textContent = soundEnabled ? 'üîä' : 'üîá';
        });

        document.getElementById('saveBtn').addEventListener('click', saveProgress);
        document.getElementById('backBtn').addEventListener('click', goBack);

        document.getElementById('helpBtn').addEventListener('click', () => {
            const overlay = document.createElement('div');
            overlay.className = 'tutorial-overlay';
            overlay.innerHTML = `
                <div class="tutorial-content">
                    <h2>‚ú® Welcome Traveler</h2>
                    <p><strong>üö™ Three Doors:</strong> Each leads to a unique world</p>
                    <p><strong>‚å®Ô∏è Keyboard:</strong> Arrow keys + Enter to navigate</p>
                    <p><strong>üîô Back:</strong> Undo your last choice</p>
                    <p><strong>üíæ Save:</strong> Your journey is saved automatically</p>
                    <button class="back-btn" onclick="this.parentElement.parentElement.remove()">Begin Your Journey</button>
                </div>
            `;
            document.body.appendChild(overlay);
        });

        // Keyboard navigation
        document.addEventListener('keydown', (e) => {
            const doors = document.querySelectorAll('.door');
            const choices = document.querySelectorAll('.choice-btn');
            const elements = doors.length > 0 ? doors : choices;

            if (elements.length === 0) return;

            if (e.key === 'ArrowRight' || e.key === 'ArrowDown') {
                e.preventDefault();
                elements[selectedChoice]?.classList.remove('keyboard-focus');
                selectedChoice = (selectedChoice + 1) % elements.length;
                elements[selectedChoice]?.classList.add('keyboard-focus');
                elements[selectedChoice]?.scrollIntoView({ behavior: 'smooth', block: 'center' });
            } else if (e.key === 'ArrowLeft' || e.key === 'ArrowUp') {
                e.preventDefault();
                elements[selectedChoice]?.classList.remove('keyboard-focus');
                selectedChoice = selectedChoice === 0 ? elements.length - 1 : selectedChoice - 1;
                elements[selectedChoice]?.classList.add('keyboard-focus');
                elements[selectedChoice]?.scrollIntoView({ behavior: 'smooth', block: 'center' });
            } else if (e.key === 'Enter' && elements[selectedChoice]) {
                e.preventDefault();
                elements[selectedChoice].click();
            } else if (e.key === 'Escape') {
                goBack();
            }
        });

        if (localStorage.getItem('hallwayProgress')) {
            if (confirm('Continue your journey?')) {
                loadProgress();
            } else {
                displayScene('hallway');
            }
        } else {
            if (!localStorage.getItem('hallwayVisited')) {
                localStorage.setItem('hallwayVisited', 'true');
                document.getElementById('helpBtn').click();
            }
            displayScene('hallway');
        }

        createParticles();

        setInterval(() => {
            if (currentScene !== 'hallway') {
                localStorage.setItem('hallwayProgress', JSON.stringify({
                    scene: currentScene,
                    history: history
                }));
            }
        }, 30000);
    </script>
</body>
</html>
